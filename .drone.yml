kind: pipeline
type: docker
name: default
steps:
  - name: greeting
    image: alpine
    commands:
      - echo hello
      - echo world
- name: notify-wechatwork
    image: fifsky/drone-wechat-work
    pull: if-not-exists
    settings:
      url: https://qyapi.weixin.qq.com/cgi-bin/webhook/send?key=43d424c0-3581-4e26-a9a3-c985ac48e31b
      msgtype: markdown
      content: |
        {{if eq .Status "success" }}
        #### ðŸŽ‰ ${DRONE_REPO} æµ‹è¯•çŽ¯å¢ƒæž„å»ºæˆåŠŸ
        > Branch: ${DRONE_BRANCH}
        > Commit: [${DRONE_COMMIT_MESSAGE}  ](${DRONE_COMMIT_LINK})
        > Author: ${DRONE_COMMIT_AUTHOR}
        > PATH: http://test.tall.wiki/checkwork/
        > [ç‚¹å‡»æŸ¥çœ‹](http://test.tall.wiki/checkwork/)
        {{else}}
        #### âŒ ${DRONE_REPO} æµ‹è¯•çŽ¯å¢ƒæž„å»ºå¤±è´¥
        > Branch: ${DRONE_BRANCH}
        > Commit: [${DRONE_COMMIT_MESSAGE}  ](${DRONE_COMMIT_LINK})
        > Author: ${DRONE_COMMIT_AUTHOR}
        > è¯·ç«‹å³ä¿®å¤!!!
        > [ç‚¹å‡»æŸ¥çœ‹](http://test.tall.wiki/checkwork/)
        {{end}}
    when:
      status:
        - failure
        - success

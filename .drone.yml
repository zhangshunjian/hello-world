kind: pipeline
type: docker
name: default
steps:
  - name: greeting
    image: alpine
    commands:
      - echo hello
      - echo world
  - name: notify
    image: fifsky/drone-wechat-work
    pull: always
    settings:
      url: https://qyapi.weixin.qq.com/cgi-bin/webhook/send?key=43d424c0-3581-4e26-a9a3-c985ac48e31b
      msgtype: markdown
      content: |
        {{if eq .Status "success" }}
        #### ðŸŽ‰ ${DRONE_REPO} æž„å»ºæˆåŠŸ
        > Commit: [${DRONE_COMMIT_MESSAGE}](${DRONE_COMMIT_LINK})
        > Author: ${DRONE_COMMIT_AUTHOR}
        > [ç‚¹å‡»æŸ¥çœ‹](${DRONE_BUILD_LINK})
        {{else}}
        #### âŒ ${DRONE_REPO} æž„å»ºå¤±è´¥
        > Commit: [${DRONE_COMMIT_MESSAGE}](${DRONE_COMMIT_LINK})
        > Author: ${DRONE_COMMIT_AUTHOR}
        > è¯·ç«‹å³ä¿®å¤!!!
        > [ç‚¹å‡»æŸ¥çœ‹](${DRONE_BUILD_LINK})
        {{end}}
    when:
      status:
        - failure
        - success
